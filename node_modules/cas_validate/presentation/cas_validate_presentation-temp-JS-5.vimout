\SYNBOL{}\SYN[Identifier]{var} redirecter = \SYN[Identifier]{function} \SYN[javaScriptParens]{(}req,res,next\SYN[javaScriptParens]{)}\SYN[Identifier]{\{}\SYNEOL{}
\SYNBOL{}    \SYN[Comment]{// decide endpoint where CAS server}\SYNEOL{}
\SYNBOL{}    \SYN[Comment]{// will return to}\SYNEOL{}
\SYNBOL{}    \SYN[Identifier]{var} service = determine_service\SYN[javaScriptParens]{(}req\SYN[javaScriptParens]{)}\SYNEOL{}
\SYNBOL{}    \SYN[Identifier]{var} queryopts = \SYN[Identifier]{\{}\SYN[Constant]{'service'}:service\SYN[Identifier]{\}}\SYNEOL{}
\SYNBOL{}    res.writeHead\SYN[javaScriptParens]{(}\SYN[javaScriptValue]{307},\SYNEOL{}
\SYNBOL{}        \SYN[Identifier]{\{} \SYN[Constant]{'location'}: cas_host+login_service +\SYN[Constant]{'?'}\SYNEOL{}
\SYNBOL{}               +querystring.stringify\SYN[javaScriptParens]{(}queryopts\SYN[javaScriptParens]{)}\SYNEOL{}
\SYNBOL{}        \SYN[Identifier]{\}}\SYN[javaScriptParens]{)}\SYNEOL{}
\SYNBOL{}    \SYN[Statement]{return} res.end\SYN[javaScriptParens]{()}\SYNEOL{}
\SYNBOL{}\SYN[Identifier]{\}}\SYNEOL{}
